---
title: "Tarea 1"
author: "Sergio Cubero Soto"
date: "17/8/2020"
output:
  html_document: 
    df_print: kable
    toc: yes
    highlight: monochrome
    theme: paper
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("/cloud/project/Tareas/Tarea1")
```


```{r paquetes, include=FALSE}
library(ggfortify)
library(forecast)
library(fpp2)
library(data.table)
library(TTR)
library(xts)
library(readxl)
library(plotly)
```

**1. Clasiﬁque las siguientes series (discreta o continua, univariada o multivariada)**

*a.* Índice diario de bolsa de valores durante el período de enero 1990 a diciembre 2010. **R/ Continua Univariada**

*b.* Registro de la marea en un lugar especíﬁco durante 30 días. **R/ Continua Univariada**

*c.* Presión sanguínea de una mujer durante el embarazo. **R/ Continua Univariada**

*d.* Temperatura promedio diario durante el año 2019.**R/ Discreta Univariada**

*e*. Registro diario de nacimiento y defunciones durante el año 2010. **R/ Discreta Multivariada**

**3. En la base de datos “nacimiento1990_1995.xls” se tienen las cifras de los nacimientos mensuales inscritos en Costa Rica de enero de 1990 a diciembre de 1995.**

**a.** Importe los datos a R.

```{r}

naci <- read_excel("Datos/nacimiento1990_1995.xls", 
    col_names = c("Fecha","Nacimientos"))

nacits<-ts(naci$Nacimientos,frequency = 12,start=c(1990,1))


frequency(nacits) #la frecuencia de la serie
cycle(nacits) #verificar el ciclo de cada observación

```


**b.** Elabore un gráﬁco de la serie.

```{r}
p<-autoplot(nacits) + 
  labs(x ="t", y = "Nacimientos", title=" Evolución de los nacimientos (ene-90 a dic-1995)")+
  theme_classic()

ggplotly(p)

ggsubseriesplot(nacits)+
  theme_bw()

decomposeNacitsMult <- decompose(nacits,"multiplicative")
decomposeNacitsAditi <- decompose(nacits,"additive")

p1<-autoplot(decomposeNacitsMult)+
  theme_bw()+
  ggtitle("Descomposición Multiplicativa")

ggplotly(p1)

p2<-autoplot(decomposeNacitsAditi)+
  theme_bw()+
  ggtitle("Descomposición Aditiva")

ggplotly(p2)

boxplot(nacits~cycle(nacits),xlab="mes", ylab = "nacimientos")

p3<-ggseasonplot(nacits, year.labels=FALSE, continuous=TRUE)+
  theme_bw()
ggplotly(p3)

ggseasonplot(nacits, year.labels=FALSE, continuous=TRUE, polar = TRUE)+
  theme_bw()

ggsubseriesplot(nacits)+
  theme_bw()
```


**c.** Comente sobre las características de la serie.




**9. Utilice la serie fpp2::goog de la bolsa de valores del Google entre 25 de febrero, 2013 a 13 de febrero, 2017.**

a. Haga un gráﬁco lineal de la serie y comente las características de esta serie.

```{r}
accgoogle<-fpp2::goog
str(accgoogle)
head(accgoogle)

pgoogle<-autoplot(accgoogle)+
  theme_bw()

ggplotly(pgoogle)
```


b. Una serie diferenciada Zt de la serie Yt es deﬁnida como

Zt = Yt −Yt−1.

Zt mide el cambio que produce la observación en el tiempo t con respecto a la observación en el tiempo t − 1. Utilice la función diff(goog) para obtener los cambios diarios de la serie.

```{r}
zt<-diff(accgoogle)

```


c. Haga un gráﬁco lineal de la serie obtenida en b. ¿La serie parece a un ruido blanco?

```{r}
pzt<-autoplot(zt)+
  theme_bw()

ggplotly(pzt)
```


d. Utilice la función ggAcf() para calcular la función de autocorrelación y compárela con la función de autocorrelación de los ruidos blancos.


```{r}

pzt2<- ggAcf(zt)+
  theme_bw()

ggplotly(pzt2)
```

